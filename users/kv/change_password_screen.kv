#:import ChangePasswordScreen users.screen

<ChangePasswordScreen>
    name: 'change_password_screen'



    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            type_height: 'small'
            #specific_text_color: 'gray'
            md_bg_color: root.md_bg_color
            left_action_items: [['arrow-left', lambda x: app.back(screen='settings_screen')]]
            elevation: 0

        MDFloatLayout:

            MDBoxLayout:
                orientation: 'vertical'
                spacing: dp(10)
                pos_hint: {'center_x': .5, 'center_y': .5}
                adaptive_height: True
                size_hint_max_x: dp(300)

                MDRelativeLayout:
                    size_hint: 1, None
                    height: current_password_field.height

                    MDTextField:
                        id: current_password_field
                        theme_text_color: 'Custom'
    #                    text_color_normal: 'white'
                        text_color_focus: '#5dff00'
    #                    hint_text_color_normal: 'white'
                        hint_text_color_focus: '#5dff00'
    #                    icon_left_color_normal: 'white'
                        icon_left_color_focus: '#5dff00'
                        line_color_focus: '#5dff00'
                        hint_text: 'Current password'
                        icon_left: 'key-variant'
                        password: True
                        helper_text_mode: 'on_error'
                        unfocus_on_touch: False if platform == 'android' else True

                    MDIconButton:
                        icon: "eye-off"
                        pos_hint: {"center_y": .5}
                        pos: current_password_field.width - self.width, 0
    #                    theme_text_color: "Custom"
    #                    text_color: 'white'
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            current_password_field.password = False if current_password_field.password is True else True

                MDRelativeLayout:
                    size_hint: 1, None
                    height: new_password_field.height

                    MDTextField:
                        id: new_password_field
                        theme_text_color: 'Custom'
    #                    text_color_normal: 'white'
                        text_color_focus: '#5dff00'
    #                    hint_text_color_normal: 'white'
                        hint_text_color_focus: '#5dff00'
    #                    icon_left_color_normal: 'white'
                        icon_left_color_focus: '#5dff00'
                        line_color_focus: '#5dff00'
                        hint_text: 'New password'
                        icon_left: 'key-variant'
                        password: True
                        helper_text_mode: 'on_error'
                        unfocus_on_touch: False if platform == 'android' else True

                    MDIconButton:
                        icon: "eye-off"
                        pos_hint: {"center_y": .5}
                        pos: new_password_field.width - self.width, 0
    #                    theme_text_color: "Custom"
    #                    text_color: 'white'
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            new_password_field.password = False if new_password_field.password is True else True

                MDRelativeLayout:
                    size_hint: 1, None
                    height: re_new_password_field.height

                    MDTextField:
                        id: re_new_password_field
                        theme_text_color: 'Custom'
    #                    text_color_normal: 'white'
                        text_color_focus: '#5dff00'
    #                    hint_text_color_normal: 'white'
                        hint_text_color_focus: '#5dff00'
    #                    icon_left_color_normal: 'white'
                        icon_left_color_focus: '#5dff00'
                        line_color_focus: '#5dff00'
                        hint_text: 'Repeat password'
                        icon_left: 'key-variant'
                        password: True
                        helper_text_mode: 'on_error'
                        unfocus_on_touch: False if platform == 'android' else True

                    MDIconButton:
                        icon: "eye-off"
                        pos_hint: {"center_y": .5}
                        pos: re_new_password_field.width - self.width, 0
    #                    theme_text_color: "Custom"
    #                    text_color: 'white'
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            re_new_password_field.password = False if re_new_password_field.password is True else True

                MDRaisedButton:
                    text: 'Change'
                    font_name: 'core/font/Barcelona-Graffiti-Bombing.otf'
                    font_size: sp(30)
                    md_bg_color: 'green'
                    pos_hint: {'center_x': .5, 'center_y': .3}
                    on_release:
                        root.change_password(current_password_field.text, new_password_field.text, re_new_password_field.text)