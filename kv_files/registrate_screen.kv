#:import RegistrateScreen screens
#:import SlideTransition kivymd.uix.transition.transition.MDSlideTransition
#:import platform kivy.utils


<RegTextField@MDTextField>
    mode: "rectangle"
    text_color_normal: 'white'
    hint_text_color_normal: 'white'
    helper_text_mode: 'on_error'


<RegistrateScreen>
    name: 'reg_screen'

    MDFloatLayout:

        MyTopAppBar:
            pos_hint: {'top': 1}
            type_height: 'small'
            title: 'Registrate'
            anchor_title: 'left'
            md_bg_color: root.md_bg_color
            left_action_items: [['arrow-left-bold', lambda x: app.back(screen='start_screen')]]
            elevation: 0

        MDBoxLayout:
            orientation: 'vertical'
            spacing: dp(30)
            pos_hint: {'center_x': .5, 'center_y': .65}
            adaptive_height: True
            size_hint_max_x: dp(300)

            RegTextField:
                id: email_field
                hint_text: 'email'
                pos_hint: {'center_x': .5}

            MDRelativeLayout:
                size_hint: 1, None
                height: password_field.height
                pos_hint: {'center_x': .5}

                RegTextField:
                    id: password_field
                    hint_text: 'Password'
                    password: True

                MyIconButton:
                    icon: "eye"
                    pos_hint: {"center_y": .45}
                    pos: password_field.width - self.width, 0
                    theme_text_color: "Custom"
                    text_color: password_field.text_color_focus if password_field.focus else 'white'
                    on_release:
                        self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                        password_field.password = False if password_field.password is True else True

            MDRelativeLayout:
                size_hint: 1, None
                height: re_password_field.height
                pos_hint: {'center_x': .5}

                RegTextField:
                    id: re_password_field
                    hint_text: 'Password repeat'
                    password: True

                MyIconButton:
                    icon: "eye"
                    pos_hint: {"center_y": .45}
                    pos: re_password_field.width - self.width, 0
                    theme_text_color: "Custom"
                    text_color: re_password_field.text_color_focus if re_password_field.focus else 'white'
                    on_release:
                        self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                        re_password_field.password = False if re_password_field.password is True else True

            MDBoxLayout:
                orientation: 'horizontal'
                adaptive_height: True
                pos_hint: {'center_x': .5}
                size_hint_max_x: dp(300)

                MDRaisedButton:
                    text: 'Registrate'
                    font_size: sp(20)
                    size_hint_x: 1
                    md_bg_color: app.theme_cls.primary_color
                    on_release:
                        root.registrate(email_field.text, password_field.text, re_password_field.text)
