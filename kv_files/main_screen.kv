#:import MainScreen screens
#:import ScrollEffect kivy.effects.scroll.ScrollEffect

<ContentNavigationDrawer@MDBoxLayout>:
    orientation: 'horizontal'

<AvatarBox@ButtonBehavior+MDBoxLayout>


<MainCard@MDCard>:
    md_bg_color: 69/255,55/255,86/255, .2
    orientation: 'vertical'
    padding: dp(10)
    spacing: dp(15)
    radius: dp(25)
    ripple_behavior: True
    image: ''
    text: ''

    Image:
        source: root.image
        fit_mode: 'contain'
        mipmap: True

    MDLabel:
        halign: 'center'
        text: root.text
        font_style: 'H6'
        adaptive_height: True


<MainScreen>
    name: 'main_screen'
    md_bg_color: app.theme_cls.bg_light

    MDBoxLayout:
        orientation: 'vertical'
        md_bg_color: root.md_bg_color if nav_drawer.state == 'close' else app.theme_cls.bg_dark

        MDTopAppBar:
            id: main_top_bar
            type_height: 'small'
            md_bg_color: self.parent.md_bg_color
            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
            elevation: 0

        MDGridLayout:
            cols: 2
            padding: dp(15), dp(15), dp(15), dp(35)
            spacing: dp(15)

            MainCard:
                image: 'assets/img/picture_icon.png'
                text: 'Create image'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'create_image_screen'

            MainCard:
                image: 'assets/img/pencil_icon.png'
                text: 'Edit image'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'edit_image_screen'

            MainCard:
                image: 'assets/img/magic_icon.png'
                text: 'Variable image'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'variable_image_screen'

            MainCard:
                image: 'assets/img/music_icon.png'
                text: 'Speech to text'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'speech_to_text_screen'

            MainCard:
                image: 'assets/img/chat_icon.png'
                text: 'Chat gpt'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'chat_gpt_screen'

            MainCard:
                image: 'assets/img/books.png'
                text: 'instruction'
                on_release:
                    app.root.transition = MDSwapTransition()
                    app.root.current = 'instruction_screen'

    MDNavigationLayout:

        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:
                do_scroll_y: False

                ContentNavigationDrawer:
                    adaptive_height: True
                    padding: dp(5)

                    MDFloatLayout:
                        size_hint_x: .4
                        size_hint_y: None
                        height: profile_info.height

                        AvatarBox:
                            source: root.avatar
                            size_hint: None, None
                            size: dp(85), dp(85)
                            pos_hint: {'center_x': .5, 'center_y': .5}
                            on_release:
                                app.file_manager_open()

                            FitImage:
                                source: self.parent.source
                                mipmap: True
                                radius: dp(50), dp(50), dp(50), dp(50)


                    MDFloatLayout:
                        id: profile_info
                        size_hint_x: .6
                        size_hint_y: None
                        height: dp(100)

                        MDLabel:
                            text: root.email
                            pos_hint: {'center_x': .5, 'center_y': .9}
                            adaptive_size: True

                        MDBoxLayout:
                            orientation: 'horizontal'
                            adaptive_size: True
                            spacing: dp(5)
                            pos_hint: {'center_x': .5, 'center_y': .55}

                            Image:
                                source: 'assets/img/coin_icon.png'
                                size_hint: None, None
                                fit_mode: 'contain'
                                mipmap: True
                                size: dp(25), dp(25)

                            MDLabel:
                                text: str(root.coin)
                                color: '#FFD700'
                                adaptive_width: True

                        MDBoxLayout:
                            orientation: 'horizontal'
                            adaptive_height: True
                            pos_hint: {'x': 0, 'y': 0}

                            MDBoxLayout:
                                orientation: 'horizontal'
                                adaptive_height: True
                                spacing: dp(5)
                                pos_hint: {'center_y': .5}

                                Image:
                                    source: 'assets/img/chat_icon.png'
                                    size_hint: None, None
                                    fit_mode: 'contain'
                                    mipmap: True
                                    size: dp(25), dp(25)

                                MDLabel:
                                    text: str(root.chat_token)
                                    color: '#157ded'
                                    adaptive_width: True

                            MDRaisedButton:
                                text: "add"
                                md_bg_color: "green"
                                size_hint_y: .5
                                pos_hint: {'center_y': .5}
                                on_release:
                                    root.add_chat_token()

                MDNavigationDrawerDivider:

                MDNavigationDrawerItem:
                    icon: "assets/img/settings_icon.png"
                    text: "Settings"
                    theme_text_color: 'Custom'
                    text_color: 'white'
                    focus_color: app.theme_cls.primary_color
                    selected_color: "white"
                    on_release:
                        root.open_settings()

                MDNavigationDrawerDivider:

                MDNavigationDrawerItem:
                    id: collection
                    icon: 'assets/img/picture_icon.png'
                    icon_size: sp(20)
                    text: 'My Collection'
                    theme_text_color: 'Custom'
                    text_color: 'white'
                    focus_color: app.theme_cls.primary_color
                    selected_color: "white"
                    on_release:
                        root.open_collection()

                MDNavigationDrawerDivider:

                MDNavigationDrawerItem:
                    icon: 'assets/img/shopping_cart.png'
                    text: 'Buy Coins'
                    theme_text_color: 'Custom'
                    text_color: 'white'
                    focus_color: app.theme_cls.primary_color
                    selected_color: "white"
                    on_release:
                        root.open_buy_credits()

                MDNavigationDrawerDivider:

                MDNavigationDrawerItem:
                    icon: 'assets/img/video_icon.png'
                    text: 'Earn Coins'
                    theme_text_color: 'Custom'
                    text_color: 'white'
                    focus_color: app.theme_cls.primary_color
                    selected_color: "white"
                    on_release:
                        root.show_ads()

                MDNavigationDrawerDivider:

                MDNavigationDrawerItem:
                    icon: 'assets/img/key_icon.png'
                    text: 'Logout'
                    theme_text_color: 'Custom'
                    text_color: 'white'
                    focus_color: app.theme_cls.primary_color
                    selected_color: 'white'
                    on_release:
                        root.exit()
















