
#:import MainScreen screens
#:import ScrollEffect kivy.effects.scroll.ScrollEffect

<ContentNavigationDrawer@MDBoxLayout>:
    orientation: 'vertical'


<AvatarBox@ButtonBehavior+MDBoxLayout>:


<MyNavigationDrawerDivider@MDNavigationDrawerDivider>:
    color: app.theme_cls.primary_color


<MyNavigationDrawerItem@MDNavigationDrawerItem>:
    text_color: 'white'
    focus_color: app.theme_cls.primary_color
    selected_color: "white"


<MainCard@MDCard>:
    md_bg_color: 69/255,55/255,86/255, .2
    orientation: 'vertical'
    padding: dp(10)
    spacing: dp(15)
    radius: dp(25)
    ripple_behavior: True
    image: ''
    text: ''

    Image:
        source: root.image
        fit_mode: 'contain'
        mipmap: True

    MDLabel:
        halign: 'center'
        text: root.text
        font_style: 'H6'
        adaptive_height: True


<MainScreen>
    name: 'main_screen'

    MDNavigationLayout:

        MDScreenManager:

            MDScreen:

                MDBoxLayout:
                    orientation: 'vertical'
                    md_bg_color: root.md_bg_color

                    MyTopAppBar:
                        id: main_top_bar
                        type_height: 'small'
                        md_bg_color: self.parent.md_bg_color
                        left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                        elevation: 0

                    MDGridLayout:
                        cols: 2
                        padding: dp(15), dp(15), dp(15), dp(35)
                        spacing: dp(15)

                        MainCard:
                            image: 'assets/img/picture_icon.png'
                            text: 'Create image'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'create_image_screen'

                        MainCard:
                            image: 'assets/img/pencil_icon.png'
                            text: 'Edit image'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'edit_image_screen'

                        MainCard:
                            image: 'assets/img/magic_icon.png'
                            text: 'Variable image'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'variable_image_screen'

                        MainCard:
                            image: 'assets/img/music_icon.png'
                            text: 'Speech to text'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'speech_to_text_screen'

                        MainCard:
                            image: 'assets/img/chat_icon.png'
                            text: 'Chat gpt'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'chat_gpt_screen'

                        MainCard:
                            image: 'assets/img/books.png'
                            text: 'instruction'
                            on_release:
                                app.root.transition = MDSwapTransition()
                                app.root.current = 'instruction_screen'

        MDNavigationDrawer:
            id: nav_drawer
            orientation: 'vertical'
            radius: (0, dp(25), dp(25), 0)
            elevation: dp(2) if self.state == 'open' else 0
            shadow_color: app.theme_cls.primary_color
            padding: [dp(15), dp(15), dp(30), dp(15)]
            size_hint_y: .95
            pos_hint: {'center_y': .5}
            scrim_color: 0, 0, 0, .2

            ContentNavigationDrawer:
                spacing: dp(10)
                adaptive_height: True

                MDLabel:
                    text: root.email
                    halign: 'center'
                    font_size: sp(20)
                    color: 'white'
                    adaptive_height: True

                MDBoxLayout:
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(100)

                    MDAnchorLayout:
                        size_hint_x: .4

                        AvatarBox:
                            source: root.avatar
                            size_hint: None, None
                            size: dp(85), dp(85)
                            anchor_x: 'center'
                            anchor_y: 'center'
                            on_release:
                                app.file_manager_open()
                                print(nav_drawer.shadow_softness)
                                print(nav_drawer.shadow_offset)

                            FitImage:
                                source: self.parent.source
                                mipmap: True
                                radius: dp(50), dp(50), dp(50), dp(50)

                    MDBoxLayout:
                        orientation: 'horizontal'
                        size_hint_x: .6

                        MDBoxLayout:
                            orientation: 'vertical'
                            pos_hint: {'center_y': .5}
                            spacing: dp(30)
                            padding: dp(20)
                            adaptive_height: True

                            MDBoxLayout:
                                orientation: 'horizontal'
                                spacing: dp(15)
                                adaptive_size: True

                                MDIcon:
                                    icon: 'crown-circle'
                                    icon_size: sp(25)
                                    theme_text_color: 'Custom'
                                    text_color: '#FFD700'

                                MDLabel:
                                    text: str(root.coin)
                                    color: '#FFD700'
                                    adaptive_width: True

                            MDBoxLayout:
                                orientation: 'horizontal'
                                spacing: dp(15)
                                adaptive_size: True

                                MDIcon:
                                    icon: 'water-circle'
                                    icon_size: sp(25)
                                    theme_text_color: 'Custom'
                                    text_color: '#157ded'

                                MDLabel:
                                    text: str(root.chat_token)
                                    color: '#157ded'
                                    adaptive_width: True

                        MyIconButton:
                            icon: 'swap-vertical-circle-outline'
                            icon_size: sp(30)
                            theme_icon_color: "Custom"
                            md_bg_color: root.md_bg_color
                            pos_hint: {'center_y': .5}
                            on_release:
                                root.add_chat_token()

            MDNavigationDrawerMenu:
                do_scroll_x: False
                effect_cls: ScrollEffect
                bar_width: 0

                MyNavigationDrawerDivider:

                MyNavigationDrawerItem:
                    icon: "cog"
                    text: "Settings"
                    on_release:
                        root.open_settings()

                MyNavigationDrawerDivider:

                MyNavigationDrawerItem:
                    id: collection
                    icon: 'image-multiple'
                    text: 'My Collection'
                    on_release:
                        root.open_collection()

                MyNavigationDrawerDivider:

                MyNavigationDrawerItem:
                    icon: 'shopping'
                    text: 'Buy Coins'
                    on_release:
                        root.open_buy_credits()

                MyNavigationDrawerDivider:

                MyNavigationDrawerItem:
                    icon: 'movie-open'
                    text: 'Earn Coins'
                    on_release:
                        root.show_ads()

                MyNavigationDrawerDivider:

                MyNavigationDrawerItem:
                    icon: 'logout'
                    text: 'Logout'
                    on_release:
                        root.exit()

                MyNavigationDrawerDivider:
















