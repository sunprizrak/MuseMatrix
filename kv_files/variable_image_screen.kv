#:import VariableImageScreen screens.variable_image


<VariableImageScreen>
    name: 'variable_image_screen'

    MDScreenManager:
        id: screen_manager

        MDScreen:
            name: 'option_section'

            MDFloatLayout:

                MDBoxLayout:
                    id: option_section
                    orientation: 'vertical'

                    MDTopAppBar:
                        type: 'small'
                        md_bg_color: self.theme_cls.backgroundColor

                        MDTopAppBarLeadingButtonContainer:

                            MDActionTopAppBarButton:
                                icon: 'arrow-left-bold'
                                ripple_effect: False
                                focus_behavior: False
                                on_release:
                                    app.back(screen='main_screen')

                        MDTopAppBarTitle:
                            text: 'variable image'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDBoxLayout:
                        id: image_box


                    MDBoxLayout:
                        orientation: 'horizontal'
                        adaptive_size: True
                        pos_hint: {'center_x': .9}
                        padding: [dp(10), dp(10), dp(10), 0]

                        MDIconButton:
                            id: img_reload
                            icon: 'image-sync'
                            style: 'outlined'
                            radius: dp(10)
                            disabled: True
                            opacity: 0 if self.disabled else 1
                            on_release:
                                root.reload_image()

                    MDBoxLayout:
                        orientation: 'vertical'
                        padding: dp(5)
                        spacing: dp(10)
                        adaptive_height: True

                        MDBoxLayout:
                            orientation: 'horizontal'
                            pos_hint: {'center_x': .5}
                            size_hint_x: None
                            width: dp(140)
                            adaptive_height: True

                            MDButton:
                                style: 'elevated'
                                size_hint: None, None
                                size: dp(30), dp(30)
                                radius: dp(15)
                                on_release:
                                    root.image_count -= 1
                                    print(self.size)

                                MDButtonIcon:
                                    icon: 'minus'
                                    pos_hint: {'center_x': .5, 'center_y': .5}


                            MDLabel:
                                id: img_count
                                text: str(root.image_count)
                                theme_font_name: "Custom"
                                font_name: 'Hacked'
                                theme_font_size: 'Custom'
                                font_size: sp(30)
                                halign: 'center'

                            MDButton:
                                style: 'elevated'
                                size_hint: None, None
                                size: dp(30), dp(30)
                                radius: dp(15)
                                on_release:
                                    root.image_count += 1

                                MDButtonIcon:
                                    icon: 'plus'
                                    pos_hint: {'center_x': .5, 'center_y': .5}

                        MDBoxLayout:
                            orientation: 'vertical'
                            adaptive_height: True
#
#                            MDSegmentedButton:
#                                id: seg_size
#                                type: 'large'
#                                selected_icon_color: 'green'
#                                pos_hint: {'center_x': .5}
#                                orientation: 'vertical'
#
#
#                                MDSegmentedButtonItem:
#                                    on_active:
#                                        root.image_size = seg_size_one.text if self.active else root.image_size
#
#                                    MDSegmentButtonLabel:
#                                        id: seg_size_one
#                                        text: '256x256'
#                                        theme_font_name: "Custom"
#                                        font_name: 'Hacked'
#                                        theme_font_size: 'Custom'
#                                        font_size: sp(16)
#
#                                MDSegmentedButtonItem:
#                                    on_active:
#                                        root.image_size = seg_size_two.text if self.active else root.image_size
#
#                                    MDSegmentButtonLabel:
#                                        id: seg_size_two
#                                        text: '512x512'
#                                        theme_font_name: "Custom"
#                                        font_name: 'Hacked'
#                                        theme_font_size: 'Custom'
#                                        font_size: sp(16)
#
#                                MDSegmentedButtonItem:
#                                    on_active:
#                                        root.image_size = seg_size_three.text if self.active else root.image_size
#
#                                    MDSegmentButtonLabel:
#                                        id: seg_size_three
#                                        text: '1024x1024'
#                                        theme_font_name: "Custom"
#                                        font_name: 'Hacked'
#                                        theme_font_size: 'Custom'
#                                        font_size: sp(16)

                            MDBoxLayout:
                                id: segmented_buttons
                                orientation: 'horizontal'
                                adaptive_size: True
                                pos_hint: {'center_x': .5}

                                MDBoxLayout:
                                    adaptive_size: True

                                    MDButton:
                                        style: 'elevated'
                                        theme_width: 'Custom'
                                        width: dp(100)
                                        radius: [dp(25), 0, 0, dp(25)]
                                        on_release:
                                            root.generate()

                                        MDButtonText:
                                            text: '256x256'
                                            pos_hint: {'center_x': .5}
                                            theme_font_name: 'Custom'
                                            font_name: 'Hacked'
                                            #theme_font_size: 'Custom'
                                            #font_size: sp(30)
                                            pos_hint: {'center_x': .5, 'center_y': .5}

                                MDBoxLayout:
                                    adaptive_size: True

                                    MDButton:
                                        style: 'elevated'
                                        theme_width: 'Custom'
                                        width: dp(100)
                                        radius: [0, 0, 0, 0]
                                        on_release:
                                            root.generate()

                                        MDButtonText:
                                            text: '512x512'
                                            pos_hint: {'center_x': .5}
                                            theme_font_name: 'Custom'
                                            font_name: 'Hacked'
                                            #theme_font_size: 'Custom'
                                            #font_size: sp(30)
                                            pos_hint: {'center_x': .5, 'center_y': .5}

                                    MDBoxLayout:
                                        adaptive_size: True

                                        MDButton:
                                            style: 'elevated'
                                            theme_width: 'Custom'
                                            width: dp(100)
                                            radius: [0, dp(25), dp(25), 0]
                                            on_release:
                                                root.generate()

                                            MDButtonText:
                                                text: '1024x1024'
                                                pos_hint: {'center_x': .5}
                                                theme_font_name: 'Custom'
                                                font_name: 'Hacked'
                                                #theme_font_size: 'Custom'
                                                #font_size: sp(30)
                                                pos_hint: {'center_x': .5, 'center_y': .5}

                            MDBoxLayout:
                                adaptive_height: True
                                size_hint_x: .5
                                width: segmented_buttons.width
                                pos_hint: {'center_x': .5}

                                MDButton:
                                    style: 'elevated'
                                    theme_width: 'Custom'
                                    size_hint_x: 1
                                    radius: [0, 0, dp(25), dp(25)]
                                    on_release:
                                        root.generate()

                                    MDButtonText:
                                        text: 'Generate'
                                        pos_hint: {'center_x': .5}
                                        theme_font_name: 'Custom'
                                        font_name: 'Hacked'
                                        theme_font_size: 'Custom'
                                        font_size: sp(30)
                                        pos_hint: {'center_x': .5, 'center_y': .5}

                MDButton:
                    id: add_image_button
                    theme_width: 'Custom'
                    width: dp(84)
                    theme_height: 'Custom'
                    height: dp(84)
                    style: 'elevated'
                    opacity: 0 if self.disabled else 1
                    pos_hint: {"center_x": .5, 'center_y': .55}
                    on_release:
                        app.file_manager_open()

                    MDButtonIcon:
                        icon: 'image-plus'
                        theme_font_size: "Custom"
                        font_size: sp(58)
                        pos_hint: {'center_x': .5, 'center_y': .5}

                MDCircularProgressIndicator:
                    id: variable_spin
                    size_hint: None, None
                    size: dp(38), dp(38)
                    pos_hint: {'center_x': .5, 'center_y': .5}
                    active: False

        MDScreen:
            name: 'completed_section'

            MDBoxLayout:
                orientation: 'vertical'

                MDBoxLayout:
                    orientation: 'horizontal'
                    padding: [dp(0), dp(10), dp(0), dp(10)]
                    spacing: dp(50)
                    pos_hint: {'center_x': .5}
                    adaptive_size: True

                    MDButton:
                        style: 'elevated'
                        radius: dp(10)
                        on_release:
                            app.root.transition = MDSwapTransition()
                            app.root.current = 'collection_screen'

                        MDButtonIcon:
                            icon: 'image-album'

                        MDButtonText:
                            text: 'gallery'
                            theme_font_name: 'Custom'
                            font_name: 'Hacked'

                    MDButton:
                        style: 'elevated'
                        radius: dp(10)
                        on_release:
                            root.variable_new_button()

                        MDButtonIcon:
                            icon: 'plus'

                        MDButtonText:
                            text: 'Variable new'
                            theme_font_name: 'Custom'
                            font_name: 'Hacked'

                MyCarousel:
                    id: carousel

                MDBoxLayout:
                    orientation: 'horizontal'
                    padding: [dp(30), dp(10), dp(30), dp(30)]
                    pos_hint: {'center_x': .5}
                    adaptive_size: True

                    MDButton:
                        id: save_button
                        style: 'elevated'
                        radius: dp(10)
                        disabled: True if carousel.current_slide in carousel.saved_images else False
                        pos_hint: {'center_x': .5}
                        on_release:
                            root.save_image(carousel.current_slide)

                        MDButtonIcon:
                            icon: 'check-circle' if carousel.current_slide in carousel.saved_images else 'content-save'
                            icon_color_disabled: 'green'

                        MDButtonText:
                            text: 'saved' if carousel.current_slide in carousel.saved_images else 'save image'
                            theme_font_name: 'Custom'
                            font_name: 'Hacked'
                            theme_text_color: 'Primary'