#:import ChangePasswordScreen screens.change_password


<ChangeTextField@MDTextField>
    mode: "outlined"
    theme_text_color: 'Custom'
    text_color_normal: 'white'
    text_color_focus: 'white'


<ChangePasswordScreen>
    name: 'change_password_screen'

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            type: 'small'
            md_bg_color: self.theme_cls.backgroundColor

            MDTopAppBarLeadingButtonContainer:

                MDActionTopAppBarButton:
                    icon: 'arrow-left-bold'
                    theme_icon_color: 'Custom'
                    icon_color: self.theme_cls.primaryColor
                    ripple_effect: False
                    focus_behavior: False
                    on_release:
                        app.back(screen='settings_screen')

            MDTopAppBarTitle:
                text: 'change password'
                theme_font_name: "Custom"
                font_name: 'Hacked'


        MDFloatLayout:

            MDBoxLayout:
                orientation: 'vertical'
                spacing: dp(10)
                pos_hint: {'top': 1, 'center_x': .5}
                adaptive_height: True
                size_hint_max_x: dp(300)

                MDRelativeLayout:
                    size_hint: 1, None
                    height: current_password_field.height
                    pos_hint: {'center_x': .5}

                    ChangeTextField:
                        id: current_password_field
                        password: True

                        MDTextFieldHintText:
                            text: 'current password'
                            text_color_normal: 'white'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDIconButton:
                        icon: "eye"
                        pos_hint: {"center_y": .45}
                        ripple_effect: False
                        focus_behavior: False
                        theme_icon_color: "Custom"
                        icon_color: current_password_field.text_color_focus if current_password_field.focus else 'white'
                        pos: current_password_field.width - self.width, 0
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            current_password_field.password = False if current_password_field.password is True else True

                MDRelativeLayout:
                    size_hint: 1, None
                    height: new_password_field.height
                    pos_hint: {'center_x': .5}

                    ChangeTextField:
                        id: new_password_field
                        password: True

                        MDTextFieldHintText:
                            text: 'new password'
                            text_color_normal: 'white'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDIconButton:
                        icon: "eye"
                        pos_hint: {"center_y": .45}
                        ripple_effect: False
                        focus_behavior: False
                        theme_icon_color: "Custom"
                        icon_color: new_password_field.text_color_focus if new_password_field.focus else 'white'
                        pos: new_password_field.width - self.width, 0
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            new_password_field.password = False if new_password_field.password is True else True

                MDRelativeLayout:
                    size_hint: 1, None
                    height: re_new_password_field.height
                    pos_hint: {'center_x': .5}

                    ChangeTextField:
                        id: re_new_password_field
                        password: True

                        MDTextFieldHintText:
                            text: 'repeat password'
                            text_color_normal: 'white'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDIconButton:
                        icon: "eye"
                        pos_hint: {"center_y": .45}
                        ripple_effect: False
                        focus_behavior: False
                        theme_icon_color: "Custom"
                        icon_color: re_new_password_field.text_color_focus if re_new_password_field.focus else 'white'
                        pos: re_new_password_field.width - self.width, 0
                        on_release:
                            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                            re_new_password_field.password = False if re_new_password_field.password is True else True

                MDBoxLayout:
                    orientation: 'horizontal'
                    adaptive_height: True
                    size_hint_max_x: dp(300)
                    pos_hint: {'center_x': .5}

                    MDButton:
                        style: "filled"
                        theme_width: 'Custom'
                        size_hint_x: 1
                        radius: dp(10)
                        on_release:
                            root.change_password(current_password_field.text, new_password_field.text, re_new_password_field.text)

                        MDButtonText:
                            text: 'Change'
                            pos_hint: {'center_x': .5}
                            theme_text_color: 'Custom'
                            text_color: 'white'
                            theme_font_name: 'Custom'
                            font_name: 'Hacked'
                            font_style: 'Display'
                            role: 'small'