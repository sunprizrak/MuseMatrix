#:import CreateImageScreen screens

<CreateImageScreen>
    name: 'create_image_screen'

    prompt: input_prompt.text

    MDFloatLayout:
        id: create_layout

        MDBoxLayout:
            id: section_option
            orientation: 'vertical'

            MDTopAppBar:
                id: create_top_bar
                type: 'small'
                theme_bg_color: 'Custom'
                md_bg_color: root.md_bg_color

                MDTopAppBarLeadingButtonContainer:

                    MDActionTopAppBarButton:
                        icon: 'arrow-left-bold'
                        ripple_effect: False
                        focus_behavior: False
                        on_release:
                            app.back(screen='main_screen')

                MDTopAppBarTitle:
                    text: 'create image'
                    theme_font_name: "Custom"
                    font_name: 'Hacked'

            MDBoxLayout:
                orientation: 'vertical'
                spacing: dp(20)

                MDSegmentedButton:
                    type: 'medium'
                    selected_icon_color: 'green'
                    size_hint_x: .8
                    pos_hint: {'center_x': .5}

                    MDSegmentedButtonItem:
                        on_active:
                            root.segment_dall_model()
                            root.dall_model = 'dall-e-2' if self.active else root.dall_model

                        MDSegmentButtonLabel:
                            text: 'DALL-2'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDSegmentedButtonItem:
                        on_active:
                            root.segment_dall_model()
                            root.dall_model = 'dall-e-3' if self.active else root.dall_model

                        MDSegmentButtonLabel:
                            text: 'DALL-3'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                MDSegmentedButton:
                    id: seg_size
                    type: 'medium'
                    selected_icon_color: 'green'
                    size_hint_x: .95
                    pos_hint: {'center_x': .5}
                    orientation: 'vertical'


                    MDSegmentedButtonItem:
                        on_active:
                            root.image_size = seg_size_one.text if self.active else root.image_size

                        MDSegmentButtonLabel:
                            id: seg_size_one
                            text: '256x256' if root.dall_model == 'dall-e-2' else '1024x1024'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDSegmentedButtonItem:
                        on_active:
                            root.image_size = seg_size_two.text if self.active else root.image_size

                        MDSegmentButtonLabel:
                            id: seg_size_two
                            text: '512x512' if root.dall_model == 'dall-e-2' else '1024x1792'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                    MDSegmentedButtonItem:
                        on_active:
                            root.image_size = seg_size_three.text if self.active else root.image_size

                        MDSegmentButtonLabel:
                            id: seg_size_three
                            text: '1024x1024' if root.dall_model == 'dall-e-2' else '1792x1024'
                            theme_font_name: "Custom"
                            font_name: 'Hacked'

                MDBoxLayout:
                    orientation: 'horizontal'
                    adaptive_height: True
                    size_hint_x: .9
                    pos_hint: {'center_x': .5}
                    spacing: dp(40)

                    MDLabel:
                        text: 'amount:'
                        theme_font_size: 'Custom'
                        font_size: sp(35)
                        theme_font_name: "Custom"
                        font_name: 'Hacked'
                        valign: 'center'
                        adaptive_size: True

                    MDBoxLayout:
                        orientation: 'horizontal'
                        pos_hint: {'center_x': .5}
                        size_hint_x: None
                        width: dp(140)
                        adaptive_height: True

                        MDIconButton:
                            icon: 'minus-box-outline'
                            theme_font_size: "Custom"
                            font_size: sp(30) if root.dall_model == 'dall-e-2' else 0
                            disabled: False if root.dall_model == 'dall-e-2' else True
                            ripple_effect: False
                            focus_behavior: False
                            theme_icon_color: "Custom"
                            icon_color: app.theme_cls.secondaryContainerColor
                            on_release:
                                root.image_count -= 1

                        MDLabel:
                            id: img_count
                            text: str(root.image_count)
                            theme_font_name: "Custom"
                            font_name: 'Hacked'
                            theme_font_size: 'Custom'
                            font_size: sp(30)
                            halign: 'center'


                        MDIconButton:
                            icon: 'plus-box-outline'
                            theme_font_size: "Custom"
                            font_size: sp(30) if root.dall_model == 'dall-e-2' else 0
                            disabled: False if root.dall_model == 'dall-e-2' else True
                            ripple_effect: False
                            focus_behavior: False
                            theme_icon_color: "Custom"
                            icon_color: app.theme_cls.secondaryContainerColor
                            on_release:
                                root.image_count += 1

                TextInput:
                    id: input_prompt
                    multiline: True
                    auto_indent: True
                    padding: dp(10)
                    border: [2, 2, 2, 2]
                    cursor_color: app.theme_cls.secondaryContainerColor
                    cursor_width: sp(3)
                    font_size: sp(17)
                    hint_text: 'Enter the prompt'
                    pos_hint: {'center_x': .5}

            MDBoxLayout:
                adaptive_height: True

                MDButton:
                    style: 'elevated'
                    theme_width: 'Custom'
                    size_hint_x: 1
                    radius: dp(0)
                    on_release:
                        root.generate()

                    MDButtonText:
                        text: 'Generate'
                        pos_hint: {'center_x': .5}
                        theme_text_color: 'Custom'
                        text_color: 'white'
                        theme_font_name: 'Custom'
                        font_name: 'Hacked'
                        font_style: 'Display'
                        role: 'small'

        MDCircularProgressIndicator:
            id: create_spin
            size_hint: None, None
            size: dp(38), dp(38)
            pos_hint: {'center_x': .5, 'center_y': .5}
            active: False