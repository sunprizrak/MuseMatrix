#:import EditImageScreen screens

<EditImageScreen>
    name: 'edit_image_screen'

    prompt: input_prompt.text

    MDFloatLayout:

        MDBoxLayout:
            orientation: 'vertical'

            MyTopAppBar:
                id: edit_top_bar
                type_height: 'small'
                title: 'edit image'
                anchor_title: 'left'
                md_bg_color: root.md_bg_color
                left_action_items: [['arrow-left-bold', lambda x: app.back(screen='main_screen')]]
                elevation: 0

            MDBoxLayout:
                id: image_section

            MDBoxLayout:
                id: option_section
                orientation: 'vertical'
                adaptive_height: True

                MDBoxLayout:
                    orientation: 'horizontal'
                    pos_hint: {'center_x': .5}
                    size_hint_x: None
                    width: dp(140)
                    adaptive_height: True

                    MyIconButton:
                        icon: 'minus-box-outline'
                        icon_size: sp(30)
                        theme_icon_color: "Custom"
                        icon_color: app.theme_cls.primary_color
                        md_bg_color: root.md_bg_color
                        on_release:
                            root.image_count -= 1

                    MDLabel:
                        id: img_count
                        text: str(root.image_count)
                        font_size: sp(30)
                        halign: 'center'

                    MyIconButton:
                        icon: 'plus-box-outline'
                        icon_size: sp(30)
                        theme_icon_color: "Custom"
                        icon_color: app.theme_cls.primary_color
                        md_bg_color: root.md_bg_color
                        on_release:
                            root.image_count += 1

                MDBoxLayout:
                    orientation: 'vertical'
                    pos_hint: {'center_x': .5}
                    adaptive_height: True

                    MySegmentedControl:
                        md_bg_color: app.theme_cls.primary_color
                        segment_color: root.md_bg_color
                        separator_color: "white"
                        radius: [dp(15), dp(15), 0, 0]
                        on_active:
                            root.image_size = self.current_active_segment.text

                        MDSegmentedControlItem:
                            text: '256x256'

                        MDSegmentedControlItem:
                            text: '512x512'

                        MDSegmentedControlItem:
                            text: '1024x1024'

                    MDBoxLayout:
                        md_bg_color: app.theme_cls.primary_color
                        size_hint_y: None
                        height: dp(150)
                        padding: [dp(3), dp(1), dp(3), dp(3)]
                        pos_hint: {'center_x': .5}

                        MDTextFieldRect:
                            id: input_prompt
                            multiline: True
                            auto_indent: True
                            padding: dp(10)
                            cursor_color: app.theme_cls.primary_color
                            cursor_width: sp(3)
                            font_size: sp(17)
                            hint_text: 'Enter the prompt'
                            line_anim: False
                            pos_hint: {'center_x': .5}

                    MDBoxLayout:
                        md_bg_color: app.theme_cls.primary_color
                        padding: [dp(3), dp(0), dp(3), dp(3)]
                        adaptive_height: True

                        MDRaisedButton:
                            text: 'Generate'
                            font_size: sp(25)
                            md_bg_color: app.theme_cls.primary_color
                            size_hint_x: 1
                            on_release:
                                root.edit_image()

        MDSpinner:
            id: edit_spin
            size_hint: None, None
            size: dp(38), dp(38)
            pos_hint: {'center_x': .5, 'center_y': .68}
            active: False

        MyIconButton:
            id: add_image_button
            icon: 'image-plus'
            icon_size: dp(70)
            theme_icon_color: "Custom"
            disabled_color: 1, 1, 1, 0
            icon_color: 'gray'
            md_bg_color: root.md_bg_color
            pos_hint: {"center_x": .5, "center_y": .7}
            on_release:
                app.file_manager_open()

